{
    "alloc_samples": 563,
    "args": [
        "cs336_basics/train_bpe.py"
    ],
    "elapsed_time_sec": 1439.2047460079193,
    "entrypoint_dir": "/Users/saudi/Desktop/language-modeling-from-scratch/assignments/assignment1-basics/cs336_basics",
    "filename": "/Users/saudi/Desktop/language-modeling-from-scratch/assignments/assignment1-basics/cs336_basics",
    "files": {
        "/Users/saudi/Desktop/language-modeling-from-scratch/assignments/assignment1-basics/cs336_basics/train_bpe.py": {
            "functions": [
                {
                    "line": "find_chunk_boundaries",
                    "lineno": 9,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.009607441189903549,
                    "n_cpu_percent_c": 0.00015227424163842952,
                    "n_cpu_percent_python": 0.0004655439142420909,
                    "n_gpu_avg_memory_mb": 464.0572916666667,
                    "n_gpu_peak_memory_mb": 464.890625,
                    "n_gpu_percent": 1.869795613869669,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0058128031059991245,
                    "n_usage_fraction": 0.0
                },
                {
                    "line": "pre_tokenize_chunk",
                    "lineno": 50,
                    "memory_samples": [
                        [
                            587044833,
                            10.634355545043945
                        ],
                        [
                            600720000,
                            10.635098457336426
                        ],
                        [
                            4145541416,
                            20.76933765411377
                        ],
                        [
                            4534471041,
                            20.782649993896484
                        ],
                        [
                            5055455041,
                            22.34671688079834
                        ],
                        [
                            5061707625,
                            9.688215255737305
                        ],
                        [
                            9154226666,
                            20.455394744873047
                        ],
                        [
                            9159891833,
                            20.366928100585938
                        ],
                        [
                            10066914333,
                            20.479124069213867
                        ],
                        [
                            11744027833,
                            20.37134075164795
                        ],
                        [
                            13065441583,
                            20.276515007019043
                        ],
                        [
                            13459270416,
                            20.382554054260254
                        ],
                        [
                            14348715458,
                            20.293561935424805
                        ],
                        [
                            18846858750,
                            20.279366493225098
                        ],
                        [
                            19283090166,
                            20.202765464782715
                        ],
                        [
                            20219100958,
                            20.048425674438477
                        ],
                        [
                            21152359416,
                            20.111848831176758
                        ],
                        [
                            22837955208,
                            19.99574565887451
                        ],
                        [
                            23199380333,
                            19.910841941833496
                        ],
                        [
                            25865167500,
                            20.024279594421387
                        ],
                        [
                            28857186541,
                            19.910194396972656
                        ],
                        [
                            29200311250,
                            19.93008804321289
                        ],
                        [
                            29223003708,
                            19.82588768005371
                        ],
                        [
                            30669018125,
                            19.81494426727295
                        ],
                        [
                            31595901333,
                            19.83372402191162
                        ],
                        [
                            32363057708,
                            19.627944946289062
                        ],
                        [
                            32782221166,
                            19.742000579833984
                        ],
                        [
                            33350838416,
                            19.735322952270508
                        ],
                        [
                            35027211125,
                            19.631522178649902
                        ],
                        [
                            35383912208,
                            19.543038368225098
                        ],
                        [
                            35526515666,
                            19.64719295501709
                        ],
                        [
                            36763358333,
                            19.539094924926758
                        ],
                        [
                            37569078833,
                            19.64047336578369
                        ],
                        [
                            44276322166,
                            19.443425178527832
                        ],
                        [
                            44714761500,
                            19.36450481414795
                        ],
                        [
                            45206533458,
                            19.456780433654785
                        ],
                        [
                            48748227041,
                            19.266796112060547
                        ],
                        [
                            48929679458,
                            19.36547088623047
                        ],
                        [
                            49218631291,
                            19.363643646240234
                        ],
                        [
                            50609137708,
                            19.255383491516113
                        ],
                        [
                            52643219333,
                            30.119571685791016
                        ],
                        [
                            52647753583,
                            17.45747470855713
                        ],
                        [
                            53741279833,
                            19.17733097076416
                        ],
                        [
                            55546432916,
                            19.271159172058105
                        ],
                        [
                            56338689875,
                            19.0831241607666
                        ],
                        [
                            57288785208,
                            19.070149421691895
                        ],
                        [
                            57851805916,
                            14.5137939453125
                        ],
                        [
                            58885057416,
                            18.886703491210938
                        ],
                        [
                            59141824541,
                            14.420315742492676
                        ],
                        [
                            62306569583,
                            18.795039176940918
                        ],
                        [
                            62840783125,
                            18.886385917663574
                        ],
                        [
                            63257545708,
                            18.99871253967285
                        ],
                        [
                            64115755791,
                            18.790536880493164
                        ],
                        [
                            65222466125,
                            14.235590934753418
                        ],
                        [
                            65426459250,
                            16.66548728942871
                        ],
                        [
                            67028021916,
                            18.618515968322754
                        ],
                        [
                            68297143541,
                            18.523672103881836
                        ],
                        [
                            68397933625,
                            14.232523918151855
                        ],
                        [
                            69099769208,
                            14.0444974899292
                        ],
                        [
                            69256958708,
                            18.606063842773438
                        ],
                        [
                            69992722666,
                            18.424582481384277
                        ],
                        [
                            70533198041,
                            18.503674507141113
                        ],
                        [
                            70536761208,
                            14.139692306518555
                        ],
                        [
                            70808554583,
                            13.954275131225586
                        ],
                        [
                            71285028458,
                            18.331403732299805
                        ],
                        [
                            73547076750,
                            18.413753509521484
                        ],
                        [
                            73549117375,
                            14.048802375793457
                        ],
                        [
                            73832023791,
                            13.855229377746582
                        ],
                        [
                            76956692125,
                            18.231307983398438
                        ],
                        [
                            76971532500,
                            13.864592552185059
                        ],
                        [
                            78287576208,
                            28.99596405029297
                        ],
                        [
                            78291893666,
                            16.324626922607422
                        ],
                        [
                            79158898250,
                            13.575902938842773
                        ],
                        [
                            79991058375,
                            18.048346519470215
                        ],
                        [
                            81035433000,
                            18.139731407165527
                        ],
                        [
                            81504112375,
                            13.772274017333984
                        ],
                        [
                            82711662875,
                            13.478074073791504
                        ],
                        [
                            83495932166,
                            17.95970916748047
                        ],
                        [
                            83629333291,
                            18.045656204223633
                        ],
                        [
                            86058543166,
                            13.678194999694824
                        ],
                        [
                            87012882041,
                            13.38650894165039
                        ],
                        [
                            87480083166,
                            17.95301342010498
                        ],
                        [
                            89763480541,
                            13.58513069152832
                        ],
                        [
                            90908754791,
                            17.768449783325195
                        ],
                        [
                            93266007958,
                            13.34000301361084
                        ],
                        [
                            93656577708,
                            17.762152671813965
                        ],
                        [
                            96943765750,
                            13.339306831359863
                        ],
                        [
                            98217804208,
                            17.56967830657959
                        ],
                        [
                            98968954375,
                            17.489726066589355
                        ],
                        [
                            99119406625,
                            13.344498634338379
                        ],
                        [
                            100067851125,
                            17.48247718811035
                        ],
                        [
                            100167473500,
                            13.355904579162598
                        ],
                        [
                            103923099000,
                            17.386473655700684
                        ],
                        [
                            104205957916,
                            17.30077075958252
                        ],
                        [
                            104363868250,
                            13.345393180847168
                        ],
                        [
                            106321777500,
                            17.212169647216797
                        ],
                        [
                            106464641791,
                            17.289737701416016
                        ],
                        [
                            106479172750,
                            13.341330528259277
                        ],
                        [
                            108450541125,
                            17.227293968200684
                        ],
                        [
                            108598517750,
                            17.19783878326416
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 30.0119938896866,
                    "n_core_utilization": 0.09726028210406255,
                    "n_cpu_percent_c": 1.7291055996194478,
                    "n_cpu_percent_python": 21.083430616182646,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 15.23541259765625,
                    "n_malloc_mb": 2005.8915700912476,
                    "n_mallocs": 153,
                    "n_peak_mb": 15.23541259765625,
                    "n_python_fraction": 0.9999826366863721,
                    "n_sys_percent": 0.6426046929956877,
                    "n_usage_fraction": 0.9479809529925031
                },
                {
                    "line": "pre_tokenize",
                    "lineno": 79,
                    "memory_samples": [
                        [
                            55075611708,
                            10.000022888183594
                        ]
                    ],
                    "n_avg_mb": 10.000022888183594,
                    "n_copy_mb_s": 0.5072641137938254,
                    "n_core_utilization": 0.0051912103302459685,
                    "n_cpu_percent_c": 0.0020769372434207354,
                    "n_cpu_percent_python": 0.2774299258936957,
                    "n_gpu_avg_memory_mb": 461.8432228195192,
                    "n_gpu_peak_memory_mb": 1207.75,
                    "n_gpu_percent": 0.2688108665773535,
                    "n_growth_mb": 10.000022888183594,
                    "n_malloc_mb": 10.000022888183594,
                    "n_mallocs": 1,
                    "n_peak_mb": 10.000022888183594,
                    "n_python_fraction": 0.984089,
                    "n_sys_percent": 5.104726203063329,
                    "n_usage_fraction": 0.004725993851729429
                },
                {
                    "line": "get_pair_counts",
                    "lineno": 111,
                    "memory_samples": [
                        [
                            112797018000,
                            20.000194549560547
                        ],
                        [
                            112888000916,
                            30.039244651794434
                        ]
                    ],
                    "n_avg_mb": 10.01961088180542,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09625620647398021,
                    "n_cpu_percent_c": 0.001957170407059204,
                    "n_cpu_percent_python": 0.006218997718710505,
                    "n_gpu_avg_memory_mb": 171.046875,
                    "n_gpu_peak_memory_mb": 171.046875,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.039050102233887,
                    "n_malloc_mb": 20.03922176361084,
                    "n_mallocs": 2,
                    "n_peak_mb": 10.039050102233887,
                    "n_python_fraction": 0.9925024795152176,
                    "n_sys_percent": 0.0003180042764845548,
                    "n_usage_fraction": 0.009470502208567412
                },
                {
                    "line": "merge_pre_token",
                    "lineno": 126,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0974221246612392,
                    "n_cpu_percent_c": 0.004540884344028081,
                    "n_cpu_percent_python": 0.01573581572591774,
                    "n_gpu_avg_memory_mb": 193.80416666666667,
                    "n_gpu_peak_memory_mb": 432.734375,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.000536539366632796,
                    "n_usage_fraction": 0.0
                },
                {
                    "line": "merge",
                    "lineno": 141,
                    "memory_samples": [
                        [
                            114514821000,
                            60.0429630279541
                        ],
                        [
                            113394349750,
                            40.03927040100098
                        ],
                        [
                            120357701708,
                            70.05846881866455
                        ],
                        [
                            186355768958,
                            10.003443717956543
                        ],
                        [
                            379537928583,
                            20.00850486755371
                        ],
                        [
                            770085019583,
                            30.011818885803223
                        ],
                        [
                            1321995978416,
                            40.0118522644043
                        ],
                        [
                            113639230375,
                            50.042922019958496
                        ]
                    ],
                    "n_avg_mb": 10.003884553909302,
                    "n_copy_mb_s": 26.391952334760763,
                    "n_core_utilization": 0.09828756649947798,
                    "n_cpu_percent_c": 57.75388626473696,
                    "n_cpu_percent_python": 12.101442858227506,
                    "n_gpu_avg_memory_mb": 185.6816887954779,
                    "n_gpu_peak_memory_mb": 898.265625,
                    "n_gpu_percent": 0.07465285415538127,
                    "n_growth_mb": 20.015531539916992,
                    "n_malloc_mb": 80.03107643127441,
                    "n_mallocs": 8,
                    "n_peak_mb": 20.015531539916992,
                    "n_python_fraction": 0.999481853812345,
                    "n_sys_percent": 1.2170710051820612,
                    "n_usage_fraction": 0.03782255094720008
                },
                {
                    "line": "train_bpe_tokenizer",
                    "lineno": 172,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09004123593040023,
                    "n_cpu_percent_c": 0.00012749924285054186,
                    "n_cpu_percent_python": 0.0009695759912589852,
                    "n_gpu_avg_memory_mb": 156.7109375,
                    "n_gpu_peak_memory_mb": 167.59375,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00012133899885095844,
                    "n_usage_fraction": 0.0
                },
                {
                    "line": "train_bpe_tinystories",
                    "lineno": 190,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.08987979715757131,
                    "n_cpu_percent_c": 0.0020998688425640246,
                    "n_cpu_percent_python": 0.0014517563956569295,
                    "n_gpu_avg_memory_mb": 166.390625,
                    "n_gpu_peak_memory_mb": 166.390625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0003999026362740011,
                    "n_usage_fraction": 0.0
                }
            ],
            "imports": [
                "from typing import BinaryIO",
                "import os",
                "import regex as re"
            ],
            "leaks": {},
            "lines": [
                {
                    "end_outermost_loop": 1,
                    "end_region_line": 1,
                    "line": "# uv run scalene cs336_basics/train_bpe.py\n",
                    "lineno": 1,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 1,
                    "start_region_line": 1
                },
                {
                    "end_outermost_loop": 2,
                    "end_region_line": 2,
                    "line": "from multiprocessing import Pool\n",
                    "lineno": 2,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 2,
                    "start_region_line": 2
                },
                {
                    "end_outermost_loop": 3,
                    "end_region_line": 3,
                    "line": "from typing import BinaryIO\n",
                    "lineno": 3,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 3,
                    "start_region_line": 3
                },
                {
                    "end_outermost_loop": 4,
                    "end_region_line": 4,
                    "line": "import json\n",
                    "lineno": 4,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 4,
                    "start_region_line": 4
                },
                {
                    "end_outermost_loop": 5,
                    "end_region_line": 5,
                    "line": "import os\n",
                    "lineno": 5,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 5,
                    "start_region_line": 5
                },
                {
                    "end_outermost_loop": 6,
                    "end_region_line": 6,
                    "line": "import regex as re\n",
                    "lineno": 6,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 6,
                    "start_region_line": 6
                },
                {
                    "end_outermost_loop": 7,
                    "end_region_line": 7,
                    "line": "\n",
                    "lineno": 7,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 7,
                    "start_region_line": 7
                },
                {
                    "end_outermost_loop": 8,
                    "end_region_line": 8,
                    "line": "\n",
                    "lineno": 8,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 8,
                    "start_region_line": 8
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "def find_chunk_boundaries(\n",
                    "lineno": 9,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    file: BinaryIO, desired_num_chunks: int, split_special_token: bytes\n",
                    "lineno": 10,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": ") -\\u003e list[int]:\n",
                    "lineno": 11,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 12,
                    "end_region_line": 47,
                    "line": "    assert isinstance(\n",
                    "lineno": 12,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 12,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 13,
                    "end_region_line": 47,
                    "line": "        split_special_token, bytes\n",
                    "lineno": 13,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 13,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 14,
                    "end_region_line": 47,
                    "line": "    ), \"Must represent special token as a bytestring\"\n",
                    "lineno": 14,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 14,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # Take file pointer to the end of the file\n",
                    "lineno": 15,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 16,
                    "end_region_line": 47,
                    "line": "    file.seek(0, os.SEEK_END)\n",
                    "lineno": 16,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 16,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # Get the size of the file in bytes\n",
                    "lineno": 17,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 18,
                    "end_region_line": 47,
                    "line": "    file_size = file.tell()\n",
                    "lineno": 18,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 18,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # Move the file pointer back to the beginning of the file\n",
                    "lineno": 19,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 20,
                    "end_region_line": 47,
                    "line": "    file.seek(0)\n",
                    "lineno": 20,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 20,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # Chunk size in bytes\n",
                    "lineno": 21,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 22,
                    "end_region_line": 47,
                    "line": "    chunk_size = file_size // desired_num_chunks\n",
                    "lineno": 22,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 22,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # Initial guesses for chunk boundary locations, uniformly spaced\n",
                    "lineno": 23,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # Chunks start on previous index, don't include last index\n",
                    "lineno": 24,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # x x x x x x x x \\u003c|endoftext|\\u003e x x x x x \\u003c|endoftext|\\u003e x x x x x\n",
                    "lineno": 25,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # [0, chunk_size, 2*chunk_size, ..., desired_num_chunks*chunk_size]\n",
                    "lineno": 26,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # [0, chunk_size, 2*chunk_size, ..., file_size]\n",
                    "lineno": 27,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 28,
                    "end_region_line": 47,
                    "line": "    chunk_boundaries = [i * chunk_size for i in range(desired_num_chunks + 1)]\n",
                    "lineno": 28,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 28,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 29,
                    "end_region_line": 47,
                    "line": "    chunk_boundaries[-1] = file_size\n",
                    "lineno": 29,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 29,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 30,
                    "end_region_line": 47,
                    "line": "    mini_chunk_size = 4096  # Read ahead by 4k bytes at a time\n",
                    "lineno": 30,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 30,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "    for bi in range(1, len(chunk_boundaries) - 1):\n",
                    "lineno": 31,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 31
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "        initial_position = chunk_boundaries[bi]\n",
                    "lineno": 32,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 31
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "        file.seek(initial_position)  # Start at boundary guess\n",
                    "lineno": 33,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 31
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "        while True:\n",
                    "lineno": 34,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "            mini_chunk = file.read(mini_chunk_size)  # Read a mini chunk\n",
                    "lineno": 35,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.010497940636225514,
                    "n_cpu_percent_c": 0.00016638831480190832,
                    "n_cpu_percent_python": 0.00045217287805396697,
                    "n_gpu_avg_memory_mb": 463.953125,
                    "n_gpu_peak_memory_mb": 464.890625,
                    "n_gpu_percent": 2.03131615399034,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00527365342608939,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "            # If EOF, this boundary should be at the end of the file\n",
                    "lineno": 36,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "            if mini_chunk == b\"\":\n",
                    "lineno": 37,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "                chunk_boundaries[bi] = file_size\n",
                    "lineno": 38,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "                break\n",
                    "lineno": 39,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "            # Find the special token in the mini chunk\n",
                    "lineno": 40,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "            found_at = mini_chunk.find(split_special_token)\n",
                    "lineno": 41,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.002483445619327825,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 1.3371036188123862e-05,
                    "n_gpu_avg_memory_mb": 464.890625,
                    "n_gpu_peak_memory_mb": 464.890625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0005250356067462561,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "            if found_at != -1:\n",
                    "lineno": 42,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "                chunk_boundaries[bi] = initial_position + found_at\n",
                    "lineno": 43,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "                break\n",
                    "lineno": 44,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 45,
                    "end_region_line": 45,
                    "line": "            initial_position += mini_chunk_size\n",
                    "lineno": 45,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 31,
                    "start_region_line": 34
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    # Make sure all boundaries are unique, but might be fewer than desired_num_chunks\n",
                    "lineno": 46,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 9,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 47,
                    "end_region_line": 47,
                    "line": "    return sorted(set(chunk_boundaries))\n",
                    "lineno": 47,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 47,
                    "start_region_line": 9
                },
                {
                    "end_outermost_loop": 48,
                    "end_region_line": 48,
                    "line": "\n",
                    "lineno": 48,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 48,
                    "start_region_line": 48
                },
                {
                    "end_outermost_loop": 49,
                    "end_region_line": 49,
                    "line": "\n",
                    "lineno": 49,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 49,
                    "start_region_line": 49
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "def pre_tokenize_chunk(\n",
                    "lineno": 50,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "    file_path: str, start: int, end: int, special_tokens: list[str]\n",
                    "lineno": 51,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": ") -\\u003e dict[str, int]:\n",
                    "lineno": 52,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "    # Read chunk\n",
                    "lineno": 53,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 56,
                    "end_region_line": 76,
                    "line": "    with open(file_path, \"rb\") as f:\n",
                    "lineno": 54,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09716797286646717,
                    "n_cpu_percent_c": 0.00029417220488960484,
                    "n_cpu_percent_python": 0.0031389529243064105,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00010006078373228973,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 54,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 55,
                    "end_region_line": 76,
                    "line": "        f.seek(start)\n",
                    "lineno": 55,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 55,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 56,
                    "end_region_line": 76,
                    "line": "        chunk = f.read(end - start).decode(\"utf-8\", errors=\"ignore\")\n",
                    "lineno": 56,
                    "memory_samples": [
                        [
                            587044833,
                            10.634355545043945
                        ],
                        [
                            600720000,
                            10.635098457336426
                        ],
                        [
                            4145541416,
                            20.76933765411377
                        ],
                        [
                            4534471041,
                            20.782649993896484
                        ],
                        [
                            5055455041,
                            22.34671688079834
                        ],
                        [
                            9154226666,
                            20.455394744873047
                        ],
                        [
                            9159891833,
                            20.366928100585938
                        ],
                        [
                            10066914333,
                            20.479124069213867
                        ],
                        [
                            11744027833,
                            20.37134075164795
                        ],
                        [
                            13065441583,
                            20.276515007019043
                        ],
                        [
                            13459270416,
                            20.382554054260254
                        ],
                        [
                            14348715458,
                            20.293561935424805
                        ],
                        [
                            18846858750,
                            20.279366493225098
                        ],
                        [
                            19283090166,
                            20.202765464782715
                        ],
                        [
                            20219100958,
                            20.048425674438477
                        ],
                        [
                            21152359416,
                            20.111848831176758
                        ],
                        [
                            22837955208,
                            19.99574565887451
                        ],
                        [
                            23199380333,
                            19.910841941833496
                        ],
                        [
                            23598499625,
                            20.014164924621582
                        ],
                        [
                            25865167500,
                            20.024279594421387
                        ],
                        [
                            28857186541,
                            19.910194396972656
                        ],
                        [
                            29200311250,
                            19.93008804321289
                        ],
                        [
                            29223003708,
                            19.82588768005371
                        ],
                        [
                            30669018125,
                            19.81494426727295
                        ],
                        [
                            31595901333,
                            19.83372402191162
                        ],
                        [
                            32363057708,
                            19.627944946289062
                        ],
                        [
                            32782221166,
                            19.742000579833984
                        ],
                        [
                            33350838416,
                            19.735322952270508
                        ],
                        [
                            35027211125,
                            19.631522178649902
                        ],
                        [
                            35383912208,
                            19.543038368225098
                        ],
                        [
                            35526515666,
                            19.64719295501709
                        ],
                        [
                            36763358333,
                            19.539094924926758
                        ],
                        [
                            37569078833,
                            19.64047336578369
                        ],
                        [
                            44276322166,
                            19.443425178527832
                        ],
                        [
                            44714761500,
                            19.36450481414795
                        ],
                        [
                            45206533458,
                            19.456780433654785
                        ],
                        [
                            46651280208,
                            19.346927642822266
                        ],
                        [
                            48748227041,
                            19.266796112060547
                        ],
                        [
                            48929679458,
                            19.36547088623047
                        ],
                        [
                            49218631291,
                            19.363643646240234
                        ],
                        [
                            50609137708,
                            19.255383491516113
                        ],
                        [
                            52643219333,
                            30.119571685791016
                        ],
                        [
                            53741279833,
                            19.17733097076416
                        ],
                        [
                            55158112583,
                            19.165618896484375
                        ],
                        [
                            55546432916,
                            19.271159172058105
                        ],
                        [
                            56338689875,
                            19.0831241607666
                        ],
                        [
                            57288785208,
                            19.070149421691895
                        ],
                        [
                            57851805916,
                            14.5137939453125
                        ],
                        [
                            58885057416,
                            18.886703491210938
                        ],
                        [
                            59141824541,
                            14.420315742492676
                        ],
                        [
                            62306569583,
                            18.795039176940918
                        ],
                        [
                            62840783125,
                            18.886385917663574
                        ],
                        [
                            63257545708,
                            18.99871253967285
                        ],
                        [
                            64115755791,
                            18.790536880493164
                        ],
                        [
                            65222466125,
                            14.235590934753418
                        ],
                        [
                            67028021916,
                            18.618515968322754
                        ],
                        [
                            68297143541,
                            18.523672103881836
                        ],
                        [
                            68397933625,
                            14.232523918151855
                        ],
                        [
                            69099769208,
                            14.0444974899292
                        ],
                        [
                            69256958708,
                            18.606063842773438
                        ],
                        [
                            69992722666,
                            18.424582481384277
                        ],
                        [
                            70533198041,
                            18.503674507141113
                        ],
                        [
                            70536761208,
                            14.139692306518555
                        ],
                        [
                            70808554583,
                            13.954275131225586
                        ],
                        [
                            71285028458,
                            18.331403732299805
                        ],
                        [
                            73547076750,
                            18.413753509521484
                        ],
                        [
                            73549117375,
                            14.048802375793457
                        ],
                        [
                            73832023791,
                            13.855229377746582
                        ],
                        [
                            76956692125,
                            18.231307983398438
                        ],
                        [
                            76971532500,
                            13.864592552185059
                        ],
                        [
                            78287576208,
                            28.99596405029297
                        ],
                        [
                            79158898250,
                            13.575902938842773
                        ],
                        [
                            79991058375,
                            18.048346519470215
                        ],
                        [
                            81035433000,
                            18.139731407165527
                        ],
                        [
                            81504112375,
                            13.772274017333984
                        ],
                        [
                            82711662875,
                            13.478074073791504
                        ],
                        [
                            83495932166,
                            17.95970916748047
                        ],
                        [
                            83629333291,
                            18.045656204223633
                        ],
                        [
                            86058543166,
                            13.678194999694824
                        ],
                        [
                            87012882041,
                            13.38650894165039
                        ],
                        [
                            87480083166,
                            17.95301342010498
                        ],
                        [
                            89763480541,
                            13.58513069152832
                        ],
                        [
                            90908754791,
                            17.768449783325195
                        ],
                        [
                            93266007958,
                            13.34000301361084
                        ],
                        [
                            93656577708,
                            17.762152671813965
                        ],
                        [
                            96943765750,
                            13.339306831359863
                        ],
                        [
                            98217804208,
                            17.56967830657959
                        ],
                        [
                            98968954375,
                            17.489726066589355
                        ],
                        [
                            99119406625,
                            13.344498634338379
                        ],
                        [
                            100067851125,
                            17.48247718811035
                        ],
                        [
                            100167473500,
                            13.355904579162598
                        ],
                        [
                            103923099000,
                            17.386473655700684
                        ],
                        [
                            104205957916,
                            17.30077075958252
                        ],
                        [
                            104363868250,
                            13.345393180847168
                        ],
                        [
                            106321777500,
                            17.212169647216797
                        ],
                        [
                            106464641791,
                            17.289737701416016
                        ],
                        [
                            106479172750,
                            13.341330528259277
                        ],
                        [
                            106621277166,
                            13.340569496154785
                        ],
                        [
                            108450541125,
                            17.227293968200684
                        ],
                        [
                            108598517750,
                            17.19783878326416
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.08520061970015695,
                    "n_cpu_percent_c": 0.02252417055896033,
                    "n_cpu_percent_python": 0.046790031221264114,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 15.23541259765625,
                    "n_malloc_mb": 1994.7901983261108,
                    "n_mallocs": 152,
                    "n_peak_mb": 15.23541259765625,
                    "n_python_fraction": 0.999982551186726,
                    "n_sys_percent": 0.012039903417788295,
                    "n_usage_fraction": 0.9427344635299846,
                    "start_outermost_loop": 56,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "    # Remove special tokens\n",
                    "lineno": 57,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 58,
                    "end_region_line": 76,
                    "line": "    chunk = re.split(\n",
                    "lineno": 58,
                    "memory_samples": [
                        [
                            5061707625,
                            9.688215255737305
                        ],
                        [
                            52647753583,
                            17.45747470855713
                        ],
                        [
                            78291893666,
                            16.324626922607422
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.07507829507707332,
                    "n_core_utilization": 0.08938341284394713,
                    "n_cpu_percent_c": 0.011993618604704787,
                    "n_cpu_percent_python": 0.14774259335701492,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.018972797774348737,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 58,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 59,
                    "end_region_line": 76,
                    "line": "        \"|\".join([re.escape(special_token) for special_token in special_tokens]), chunk\n",
                    "lineno": 59,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09227351164649819,
                    "n_cpu_percent_c": 8.132725947027231e-05,
                    "n_cpu_percent_python": 0.00099361343274715,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 9.000976109960699e-05,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 59,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 60,
                    "end_region_line": 76,
                    "line": "    )\n",
                    "lineno": 60,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 60,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "    # Merge\n",
                    "lineno": 61,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 62,
                    "end_region_line": 76,
                    "line": "    chunk = \" \".join(chunk)\n",
                    "lineno": 62,
                    "memory_samples": [
                        [
                            65426459250,
                            16.66548728942871
                        ]
                    ],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.1523079476082725,
                    "n_core_utilization": 0.08626296875392937,
                    "n_cpu_percent_c": 0.006320778880277363,
                    "n_cpu_percent_python": 0.03297563434561307,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 11.101371765136719,
                    "n_malloc_mb": 11.101371765136719,
                    "n_mallocs": 1,
                    "n_peak_mb": 11.101371765136719,
                    "n_python_fraction": 0.999998,
                    "n_sys_percent": 0.00625779594813644,
                    "n_usage_fraction": 0.005246489462518477,
                    "start_outermost_loop": 62,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "    # Pre-tokenize\n",
                    "lineno": 63,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 64,
                    "end_region_line": 76,
                    "line": "    matches = re.finditer(\n",
                    "lineno": 64,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.08713140458994323,
                    "n_cpu_percent_c": 0.0008367716100025293,
                    "n_cpu_percent_python": 0.010320667948674282,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0016478625148818764,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 64,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 65,
                    "end_region_line": 76,
                    "line": "        r\"\"\"'(?:[sdmt]|ll|ve|re)| ?\\p{L}+| ?\\p{N}+| ?[^\\s\\p{L}\\p{N}]+|\\s+(?!\\S)|\\s+\"\"\",\n",
                    "lineno": 65,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 65,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 66,
                    "end_region_line": 76,
                    "line": "        chunk,\n",
                    "lineno": 66,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 66,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 67,
                    "end_region_line": 76,
                    "line": "    )\n",
                    "lineno": 67,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 67,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "    # Frequency count\n",
                    "lineno": 68,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 50,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 69,
                    "end_region_line": 76,
                    "line": "    pre_token_counts = {}\n",
                    "lineno": 69,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 69,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 75,
                    "end_region_line": 75,
                    "line": "    for match in matches:\n",
                    "lineno": 70,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 29.770708626531896,
                    "n_core_utilization": 0.09757090125569604,
                    "n_cpu_percent_c": 0.21915059314481453,
                    "n_cpu_percent_python": 2.7080669428174104,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.072875215350081,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 70,
                    "start_region_line": 70
                },
                {
                    "end_outermost_loop": 75,
                    "end_region_line": 75,
                    "line": "        pre_token = tuple(match.group())\n",
                    "lineno": 71,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09742710078902317,
                    "n_cpu_percent_c": 1.1204540212667153,
                    "n_cpu_percent_python": 13.82304655122625,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.3946347630261433,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 70,
                    "start_region_line": 70
                },
                {
                    "end_outermost_loop": 75,
                    "end_region_line": 75,
                    "line": "        if pre_token in pre_token_counts:\n",
                    "lineno": 72,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 70,
                    "start_region_line": 70
                },
                {
                    "end_outermost_loop": 75,
                    "end_region_line": 75,
                    "line": "            pre_token_counts[pre_token] += 1\n",
                    "lineno": 73,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.013899020469360767,
                    "n_core_utilization": 0.0971156561033245,
                    "n_cpu_percent_c": 0.3404732822486323,
                    "n_cpu_percent_python": 4.257788581878845,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.13656879925726045,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 70,
                    "start_region_line": 70
                },
                {
                    "end_outermost_loop": 75,
                    "end_region_line": 75,
                    "line": "        else:\n",
                    "lineno": 74,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 70,
                    "start_region_line": 70
                },
                {
                    "end_outermost_loop": 75,
                    "end_region_line": 75,
                    "line": "            pre_token_counts[pre_token] = 1\n",
                    "lineno": 75,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09572006826898964,
                    "n_cpu_percent_c": 0.0038708415053057875,
                    "n_cpu_percent_python": 0.05256704703051951,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00252350749789384,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 70,
                    "start_region_line": 70
                },
                {
                    "end_outermost_loop": 76,
                    "end_region_line": 76,
                    "line": "    return pre_token_counts\n",
                    "lineno": 76,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 76,
                    "start_region_line": 50
                },
                {
                    "end_outermost_loop": 77,
                    "end_region_line": 77,
                    "line": "\n",
                    "lineno": 77,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 77,
                    "start_region_line": 77
                },
                {
                    "end_outermost_loop": 78,
                    "end_region_line": 78,
                    "line": "\n",
                    "lineno": 78,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 78,
                    "start_region_line": 78
                },
                {
                    "end_outermost_loop": 108,
                    "end_region_line": 108,
                    "line": "def pre_tokenize(input_path: str, special_tokens: list[str]) -\\u003e dict[tuple[str], int]:\n",
                    "lineno": 79,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 79,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 81,
                    "end_region_line": 108,
                    "line": "    with open(input_path, \"rb\") as f:\n",
                    "lineno": 80,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 80,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 81,
                    "end_region_line": 108,
                    "line": "        boundaries = find_chunk_boundaries(f, 1000, special_tokens[0].encode(\"utf-8\"))\n",
                    "lineno": 81,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 81,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 108,
                    "end_region_line": 108,
                    "line": "    # outputs = []\n",
                    "lineno": 82,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 79,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 108,
                    "end_region_line": 108,
                    "line": "    # for start, end in zip(boundaries[:-1], boundaries[1:]):\n",
                    "lineno": 83,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 79,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 108,
                    "end_region_line": 108,
                    "line": "    #     output = pre_tokenize_chunk(input_path, start, end, special_tokens)\n",
                    "lineno": 84,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 79,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 108,
                    "end_region_line": 108,
                    "line": "    #     outputs.append(output)\n",
                    "lineno": 85,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 79,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 108,
                    "end_region_line": 108,
                    "line": "    #! To use multiprocessing convert the notebook to .py\n",
                    "lineno": 86,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 79,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 100,
                    "end_region_line": 108,
                    "line": "    with Pool(processes=4) as pool:\n",
                    "lineno": 87,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.5072641137938254,
                    "n_core_utilization": 0.09444746662393451,
                    "n_cpu_percent_c": 0.017885465872527217,
                    "n_cpu_percent_python": 0.09102354675518262,
                    "n_gpu_avg_memory_mb": 14.598815247252746,
                    "n_gpu_peak_memory_mb": 463.015625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00640272258415926,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 87,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 88,
                    "end_region_line": 108,
                    "line": "        tasks = []\n",
                    "lineno": 88,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 88,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "        for start, end in zip(boundaries[:-1], boundaries[1:]):\n",
                    "lineno": 89,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "            task = pool.apply_async(\n",
                    "lineno": 90,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "                pre_tokenize_chunk,\n",
                    "lineno": 91,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "                args=(\n",
                    "lineno": 92,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "                    input_path,\n",
                    "lineno": 93,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "                    start,\n",
                    "lineno": 94,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "                    end,\n",
                    "lineno": 95,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "                    special_tokens,\n",
                    "lineno": 96,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "                ),\n",
                    "lineno": 97,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "            )\n",
                    "lineno": 98,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 99,
                    "end_region_line": 99,
                    "line": "            tasks.append(task)\n",
                    "lineno": 99,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 89,
                    "start_region_line": 89
                },
                {
                    "end_outermost_loop": 100,
                    "end_region_line": 108,
                    "line": "        outputs = [t.get() for t in tasks]\n",
                    "lineno": 100,
                    "memory_samples": [
                        [
                            55075611708,
                            10.000022888183594
                        ]
                    ],
                    "n_avg_mb": 10.000022888183594,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0024132302809973874,
                    "n_cpu_percent_c": 0.00028297177726641255,
                    "n_cpu_percent_python": 0.12483666850221492,
                    "n_gpu_avg_memory_mb": 474.5228113941514,
                    "n_gpu_peak_memory_mb": 1207.75,
                    "n_gpu_percent": 0.2787770525763011,
                    "n_growth_mb": 10.000022888183594,
                    "n_malloc_mb": 10.000022888183594,
                    "n_mallocs": 1,
                    "n_peak_mb": 10.000022888183594,
                    "n_python_fraction": 0.984089,
                    "n_sys_percent": 5.0596172356298394,
                    "n_usage_fraction": 0.004725993851729429,
                    "start_outermost_loop": 100,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 101,
                    "end_region_line": 108,
                    "line": "    pre_token_counts = outputs[0]\n",
                    "lineno": 101,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 101,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 107,
                    "end_region_line": 107,
                    "line": "    for output in outputs:\n",
                    "lineno": 102,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 102,
                    "start_region_line": 102
                },
                {
                    "end_outermost_loop": 107,
                    "end_region_line": 107,
                    "line": "        for pre_token, count in output.items():\n",
                    "lineno": 103,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 102,
                    "start_region_line": 103
                },
                {
                    "end_outermost_loop": 107,
                    "end_region_line": 107,
                    "line": "            if pre_token in pre_token_counts:\n",
                    "lineno": 104,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 102,
                    "start_region_line": 103
                },
                {
                    "end_outermost_loop": 107,
                    "end_region_line": 107,
                    "line": "                pre_token_counts[pre_token] += count\n",
                    "lineno": 105,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.08226794550761284,
                    "n_cpu_percent_c": 0.0075912157754893924,
                    "n_cpu_percent_python": 0.06068224345575143,
                    "n_gpu_avg_memory_mb": 171.00148266423355,
                    "n_gpu_peak_memory_mb": 171.046875,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.014715679260035848,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 102,
                    "start_region_line": 103
                },
                {
                    "end_outermost_loop": 107,
                    "end_region_line": 107,
                    "line": "            else:\n",
                    "lineno": 106,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 102,
                    "start_region_line": 103
                },
                {
                    "end_outermost_loop": 107,
                    "end_region_line": 107,
                    "line": "                pre_token_counts[pre_token] = count\n",
                    "lineno": 107,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.08241606898567377,
                    "n_cpu_percent_c": 9.766576321715738e-05,
                    "n_cpu_percent_python": 0.0008874671805284977,
                    "n_gpu_avg_memory_mb": 171.0,
                    "n_gpu_peak_memory_mb": 171.015625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00021018364423295723,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 102,
                    "start_region_line": 103
                },
                {
                    "end_outermost_loop": 108,
                    "end_region_line": 108,
                    "line": "    return pre_token_counts\n",
                    "lineno": 108,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 108,
                    "start_region_line": 79
                },
                {
                    "end_outermost_loop": 109,
                    "end_region_line": 109,
                    "line": "\n",
                    "lineno": 109,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 109,
                    "start_region_line": 109
                },
                {
                    "end_outermost_loop": 110,
                    "end_region_line": 110,
                    "line": "\n",
                    "lineno": 110,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 110,
                    "start_region_line": 110
                },
                {
                    "end_outermost_loop": 123,
                    "end_region_line": 123,
                    "line": "def get_pair_counts(\n",
                    "lineno": 111,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 111,
                    "start_region_line": 111
                },
                {
                    "end_outermost_loop": 123,
                    "end_region_line": 123,
                    "line": "    pre_token_counts: dict[tuple[str], int],\n",
                    "lineno": 112,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 111,
                    "start_region_line": 111
                },
                {
                    "end_outermost_loop": 123,
                    "end_region_line": 123,
                    "line": ") -\\u003e dict[tuple[str], list[int, dict[tuple[str], int]]]:\n",
                    "lineno": 113,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 111,
                    "start_region_line": 111
                },
                {
                    "end_outermost_loop": 114,
                    "end_region_line": 123,
                    "line": "    pair_counts = {}\n",
                    "lineno": 114,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 114,
                    "start_region_line": 111
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 122,
                    "line": "    for pre_token, count in pre_token_counts.items():\n",
                    "lineno": 115,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 115,
                    "start_region_line": 115
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 122,
                    "line": "        for i in range(len(pre_token) - 1):\n",
                    "lineno": 116,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 115,
                    "start_region_line": 116
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 122,
                    "line": "            pair = pre_token[i : i + 2]\n",
                    "lineno": 117,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 115,
                    "start_region_line": 116
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 122,
                    "line": "            if pair in pair_counts:\n",
                    "lineno": 118,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 115,
                    "start_region_line": 116
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 122,
                    "line": "                pair_counts[pair][0] += count\n",
                    "lineno": 119,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 115,
                    "start_region_line": 116
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 122,
                    "line": "                pair_counts[pair][1][pre_token] = count\n",
                    "lineno": 120,
                    "memory_samples": [
                        [
                            112797018000,
                            20.000194549560547
                        ],
                        [
                            112888000916,
                            30.039244651794434
                        ]
                    ],
                    "n_avg_mb": 10.01961088180542,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09625620647398021,
                    "n_cpu_percent_c": 0.001957170407059204,
                    "n_cpu_percent_python": 0.006218997718710505,
                    "n_gpu_avg_memory_mb": 171.046875,
                    "n_gpu_peak_memory_mb": 171.046875,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.039050102233887,
                    "n_malloc_mb": 20.03922176361084,
                    "n_mallocs": 2,
                    "n_peak_mb": 10.039050102233887,
                    "n_python_fraction": 0.9925024795152176,
                    "n_sys_percent": 0.0003180042764845548,
                    "n_usage_fraction": 0.009470502208567412,
                    "start_outermost_loop": 115,
                    "start_region_line": 116
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 122,
                    "line": "            else:\n",
                    "lineno": 121,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 115,
                    "start_region_line": 116
                },
                {
                    "end_outermost_loop": 122,
                    "end_region_line": 122,
                    "line": "                pair_counts[pair] = [count, {pre_token: count}]\n",
                    "lineno": 122,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 115,
                    "start_region_line": 116
                },
                {
                    "end_outermost_loop": 123,
                    "end_region_line": 123,
                    "line": "    return pair_counts\n",
                    "lineno": 123,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 123,
                    "start_region_line": 111
                },
                {
                    "end_outermost_loop": 124,
                    "end_region_line": 124,
                    "line": "\n",
                    "lineno": 124,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 124,
                    "start_region_line": 124
                },
                {
                    "end_outermost_loop": 125,
                    "end_region_line": 125,
                    "line": "\n",
                    "lineno": 125,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 125,
                    "start_region_line": 125
                },
                {
                    "end_outermost_loop": 138,
                    "end_region_line": 138,
                    "line": "def merge_pre_token(pre_token: tuple[str], merge_pair: tuple[str]) -\\u003e tuple[str]:\n",
                    "lineno": 126,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09783264939721056,
                    "n_cpu_percent_c": 0.00010619027663599484,
                    "n_cpu_percent_python": 0.0010534749666265668,
                    "n_gpu_avg_memory_mb": 171.109375,
                    "n_gpu_peak_memory_mb": 171.109375,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 2.5690821821807143e-05,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 126,
                    "start_region_line": 126
                },
                {
                    "end_outermost_loop": 127,
                    "end_region_line": 138,
                    "line": "    res = []\n",
                    "lineno": 127,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 127,
                    "start_region_line": 126
                },
                {
                    "end_outermost_loop": 128,
                    "end_region_line": 138,
                    "line": "    i = 0\n",
                    "lineno": 128,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 128,
                    "start_region_line": 126
                },
                {
                    "end_outermost_loop": 136,
                    "end_region_line": 136,
                    "line": "    while i \\u003c len(pre_token):\n",
                    "lineno": 129,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0968689173222113,
                    "n_cpu_percent_c": 0.0009785296443004924,
                    "n_cpu_percent_python": 0.005737035543815377,
                    "n_gpu_avg_memory_mb": 168.7911931818182,
                    "n_gpu_peak_memory_mb": 171.140625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0002170664276356994,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 129
                },
                {
                    "end_outermost_loop": 136,
                    "end_region_line": 136,
                    "line": "        pair = pre_token[i : i + 2]\n",
                    "lineno": 130,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 129
                },
                {
                    "end_outermost_loop": 136,
                    "end_region_line": 136,
                    "line": "        if pair == merge_pair:\n",
                    "lineno": 131,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 129
                },
                {
                    "end_outermost_loop": 136,
                    "end_region_line": 136,
                    "line": "            res.append(\"\".join(pair))\n",
                    "lineno": 132,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09844581086742243,
                    "n_cpu_percent_c": 0.00046738820096643106,
                    "n_cpu_percent_python": 0.0021201551416032724,
                    "n_gpu_avg_memory_mb": 171.109375,
                    "n_gpu_peak_memory_mb": 171.140625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 4.085020690734199e-05,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 129
                },
                {
                    "end_outermost_loop": 136,
                    "end_region_line": 136,
                    "line": "            i += 2\n",
                    "lineno": 133,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 129
                },
                {
                    "end_outermost_loop": 136,
                    "end_region_line": 136,
                    "line": "        else:\n",
                    "lineno": 134,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 129
                },
                {
                    "end_outermost_loop": 136,
                    "end_region_line": 136,
                    "line": "            res.append(pre_token[i])\n",
                    "lineno": 135,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 129
                },
                {
                    "end_outermost_loop": 136,
                    "end_region_line": 136,
                    "line": "            i += 1\n",
                    "lineno": 136,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 129,
                    "start_region_line": 129
                },
                {
                    "end_outermost_loop": 137,
                    "end_region_line": 138,
                    "line": "    res = tuple(res)\n",
                    "lineno": 137,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09751208515605699,
                    "n_cpu_percent_c": 0.0029912532727607317,
                    "n_cpu_percent_python": 0.006825150073872521,
                    "n_gpu_avg_memory_mb": 225.4435096153846,
                    "n_gpu_peak_memory_mb": 432.734375,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00025045485963237846,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 137,
                    "start_region_line": 126
                },
                {
                    "end_outermost_loop": 138,
                    "end_region_line": 138,
                    "line": "    return res\n",
                    "lineno": 138,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 138,
                    "start_region_line": 126
                },
                {
                    "end_outermost_loop": 139,
                    "end_region_line": 139,
                    "line": "\n",
                    "lineno": 139,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 139,
                    "start_region_line": 139
                },
                {
                    "end_outermost_loop": 140,
                    "end_region_line": 140,
                    "line": "\n",
                    "lineno": 140,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 140,
                    "start_region_line": 140
                },
                {
                    "end_outermost_loop": 169,
                    "end_region_line": 169,
                    "line": "def merge(\n",
                    "lineno": 141,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 141,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 169,
                    "end_region_line": 169,
                    "line": "    pair_counts: dict[tuple[str], list[int, dict[tuple[str], int]]],\n",
                    "lineno": 142,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 141,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 169,
                    "end_region_line": 169,
                    "line": ") -\\u003e tuple[str]:\n",
                    "lineno": 143,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 141,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 169,
                    "end_region_line": 169,
                    "line": "    # Find top pair\n",
                    "lineno": 144,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 141,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 145,
                    "end_region_line": 169,
                    "line": "    top_pair = (\n",
                    "lineno": 145,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 145,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 146,
                    "end_region_line": 169,
                    "line": "        sorted(\n",
                    "lineno": 146,
                    "memory_samples": [
                        [
                            113394349750,
                            40.03927040100098
                        ],
                        [
                            120357701708,
                            70.05846881866455
                        ],
                        [
                            186355768958,
                            10.003443717956543
                        ],
                        [
                            379537928583,
                            20.00850486755371
                        ],
                        [
                            770085019583,
                            30.011818885803223
                        ],
                        [
                            1321995978416,
                            40.0118522644043
                        ]
                    ],
                    "n_avg_mb": 12.005476760864259,
                    "n_copy_mb_s": 26.391952334760763,
                    "n_core_utilization": 0.0986204879107764,
                    "n_cpu_percent_c": 27.594303874668,
                    "n_cpu_percent_python": 5.0023549998262,
                    "n_gpu_avg_memory_mb": 182.83328302462462,
                    "n_gpu_peak_memory_mb": 753.203125,
                    "n_gpu_percent": 0.08767614922440863,
                    "n_growth_mb": 20.015531539916992,
                    "n_malloc_mb": 60.02738380432129,
                    "n_mallocs": 5,
                    "n_peak_mb": 20.015531539916992,
                    "n_python_fraction": 0.9995226237587833,
                    "n_sys_percent": 0.45596885116489966,
                    "n_usage_fraction": 0.02836883974834126,
                    "start_outermost_loop": 146,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 147,
                    "end_region_line": 169,
                    "line": "            pair_counts.items(), key=lambda item: (item[1][0], item[0]), reverse=True\n",
                    "lineno": 147,
                    "memory_samples": [
                        [
                            114514821000,
                            60.0429630279541
                        ]
                    ],
                    "n_avg_mb": 5.000020503997803,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09809765482863911,
                    "n_cpu_percent_c": 30.180902701548607,
                    "n_cpu_percent_python": 7.036204673515878,
                    "n_gpu_avg_memory_mb": 187.62299438898063,
                    "n_gpu_peak_memory_mb": 898.265625,
                    "n_gpu_percent": 0.06347534802414563,
                    "n_growth_mb": 10.000041007995605,
                    "n_malloc_mb": 10.000041007995605,
                    "n_mallocs": 2,
                    "n_peak_mb": 10.000041007995605,
                    "n_python_fraction": 0.9993,
                    "n_sys_percent": 0.7217275951259037,
                    "n_usage_fraction": 0.004726002415121845,
                    "start_outermost_loop": 147,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 148,
                    "end_region_line": 169,
                    "line": "        )\n",
                    "lineno": 148,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 148,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 149,
                    "end_region_line": 169,
                    "line": "    )[0]\n",
                    "lineno": 149,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 149,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 150,
                    "end_region_line": 169,
                    "line": "    merge_pair = top_pair[0]\n",
                    "lineno": 150,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 150,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 151,
                    "end_region_line": 169,
                    "line": "    pre_tokens = dict(top_pair[1][1])\n",
                    "lineno": 151,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.08812968253482154,
                    "n_cpu_percent_c": 0.004264296137631388,
                    "n_cpu_percent_python": 0.022775811127894046,
                    "n_gpu_avg_memory_mb": 206.41764322916669,
                    "n_gpu_peak_memory_mb": 753.203125,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.003642072095374268,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 151,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 169,
                    "end_region_line": 169,
                    "line": "    # Update pair counts\n",
                    "lineno": 152,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 141,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 159,
                    "end_region_line": 159,
                    "line": "    for pre_token, count in pre_tokens.items():\n",
                    "lineno": 153,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0957105659532268,
                    "n_cpu_percent_c": 0.0001036807834656158,
                    "n_cpu_percent_python": 0.0010306240901645281,
                    "n_gpu_avg_memory_mb": 268.75,
                    "n_gpu_peak_memory_mb": 386.609375,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 5.083582879185633e-05,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 153,
                    "start_region_line": 153
                },
                {
                    "end_outermost_loop": 159,
                    "end_region_line": 159,
                    "line": "        for i in range(len(pre_token) - 1):\n",
                    "lineno": 154,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09749766847703172,
                    "n_cpu_percent_c": 0.0004543828044295883,
                    "n_cpu_percent_python": 0.0020997356951459106,
                    "n_gpu_avg_memory_mb": 158.4375,
                    "n_gpu_peak_memory_mb": 171.078125,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 6.555286228603392e-05,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 153,
                    "start_region_line": 154
                },
                {
                    "end_outermost_loop": 159,
                    "end_region_line": 159,
                    "line": "            pair = pre_token[i : i + 2]\n",
                    "lineno": 155,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 153,
                    "start_region_line": 154
                },
                {
                    "end_outermost_loop": 159,
                    "end_region_line": 159,
                    "line": "            if pair in pair_counts:\n",
                    "lineno": 156,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 153,
                    "start_region_line": 154
                },
                {
                    "end_outermost_loop": 159,
                    "end_region_line": 159,
                    "line": "                pair_counts[pair][0] -= count\n",
                    "lineno": 157,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 153,
                    "start_region_line": 154
                },
                {
                    "end_outermost_loop": 159,
                    "end_region_line": 159,
                    "line": "                if pre_token in pair_counts[pair][1]:\n",
                    "lineno": 158,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 153,
                    "start_region_line": 154
                },
                {
                    "end_outermost_loop": 159,
                    "end_region_line": 159,
                    "line": "                    del pair_counts[pair][1][pre_token]\n",
                    "lineno": 159,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 153,
                    "start_region_line": 154
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "    for pre_token, count in pre_tokens.items():\n",
                    "lineno": 160,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 160
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "        pre_token = merge_pre_token(pre_token, merge_pair)\n",
                    "lineno": 161,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 160
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "        for i in range(len(pre_token) - 1):\n",
                    "lineno": 162,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09709381583126792,
                    "n_cpu_percent_c": 0.00013795624638347314,
                    "n_cpu_percent_python": 0.0005227595543140191,
                    "n_gpu_avg_memory_mb": 145.765625,
                    "n_gpu_peak_memory_mb": 145.765625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 1.9776355307274157e-05,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 162
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "            pair = pre_token[i : i + 2]\n",
                    "lineno": 163,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 162
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "            if pair in pair_counts:\n",
                    "lineno": 164,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 162
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "                pair_counts[pair][0] += count\n",
                    "lineno": 165,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 162
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "                pair_counts[pair][1][pre_token] = count\n",
                    "lineno": 166,
                    "memory_samples": [
                        [
                            113639230375,
                            50.042922019958496
                        ]
                    ],
                    "n_avg_mb": 10.00365161895752,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09761999363173116,
                    "n_cpu_percent_c": 0.002767192114068269,
                    "n_cpu_percent_python": 0.0141909983247247,
                    "n_gpu_avg_memory_mb": 194.40104166666669,
                    "n_gpu_peak_memory_mb": 406.078125,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 10.00365161895752,
                    "n_malloc_mb": 10.00365161895752,
                    "n_mallocs": 1,
                    "n_peak_mb": 10.00365161895752,
                    "n_python_fraction": 0.9994189999999998,
                    "n_sys_percent": 0.00041344605482051844,
                    "n_usage_fraction": 0.004727708783736976,
                    "start_outermost_loop": 160,
                    "start_region_line": 162
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "            else:\n",
                    "lineno": 167,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 162
                },
                {
                    "end_outermost_loop": 168,
                    "end_region_line": 168,
                    "line": "                pair_counts[pair] = [count, {pre_token: count}]\n",
                    "lineno": 168,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 160,
                    "start_region_line": 162
                },
                {
                    "end_outermost_loop": 169,
                    "end_region_line": 169,
                    "line": "    return merge_pair\n",
                    "lineno": 169,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 169,
                    "start_region_line": 141
                },
                {
                    "end_outermost_loop": 170,
                    "end_region_line": 170,
                    "line": "\n",
                    "lineno": 170,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 170,
                    "start_region_line": 170
                },
                {
                    "end_outermost_loop": 171,
                    "end_region_line": 171,
                    "line": "\n",
                    "lineno": 171,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 171,
                    "start_region_line": 171
                },
                {
                    "end_outermost_loop": 187,
                    "end_region_line": 187,
                    "line": "def train_bpe_tokenizer(\n",
                    "lineno": 172,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 172,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 187,
                    "end_region_line": 187,
                    "line": "    input_path: str, vocab_size: int, special_tokens: list[int]\n",
                    "lineno": 173,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 172,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 187,
                    "end_region_line": 187,
                    "line": ") -\\u003e tuple[dict[int, bytes], list[tuple[bytes, bytes]]]:\n",
                    "lineno": 174,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 172,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 175,
                    "end_region_line": 187,
                    "line": "    pre_token_counts = pre_tokenize(input_path, special_tokens)\n",
                    "lineno": 175,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 175,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 176,
                    "end_region_line": 187,
                    "line": "    pair_counts = get_pair_counts(pre_token_counts)\n",
                    "lineno": 176,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 176,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 177,
                    "end_region_line": 187,
                    "line": "    vocab = {i: bytes([i]) for i in range(0, 256)}\n",
                    "lineno": 177,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 177,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 179,
                    "end_region_line": 179,
                    "line": "    for i, special_token in enumerate(special_tokens):\n",
                    "lineno": 178,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 178,
                    "start_region_line": 178
                },
                {
                    "end_outermost_loop": 179,
                    "end_region_line": 179,
                    "line": "        vocab[256 + i] = special_token.encode(\"utf-8\")\n",
                    "lineno": 179,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 178,
                    "start_region_line": 178
                },
                {
                    "end_outermost_loop": 180,
                    "end_region_line": 187,
                    "line": "    k = len(vocab)\n",
                    "lineno": 180,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 180,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 181,
                    "end_region_line": 187,
                    "line": "    merges = []\n",
                    "lineno": 181,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 181,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 186,
                    "end_region_line": 186,
                    "line": "    while k \\u003c vocab_size:\n",
                    "lineno": 182,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 182,
                    "start_region_line": 182
                },
                {
                    "end_outermost_loop": 186,
                    "end_region_line": 186,
                    "line": "        merge_pair = merge(pair_counts)\n",
                    "lineno": 183,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 182,
                    "start_region_line": 182
                },
                {
                    "end_outermost_loop": 186,
                    "end_region_line": 186,
                    "line": "        vocab[k] = \"\".join(merge_pair).encode(\"utf-8\")\n",
                    "lineno": 184,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09004123593040023,
                    "n_cpu_percent_c": 0.00012749924285054186,
                    "n_cpu_percent_python": 0.0009695759912589852,
                    "n_gpu_avg_memory_mb": 156.7109375,
                    "n_gpu_peak_memory_mb": 167.59375,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00012133899885095844,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 182,
                    "start_region_line": 182
                },
                {
                    "end_outermost_loop": 186,
                    "end_region_line": 186,
                    "line": "        k += 1\n",
                    "lineno": 185,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 182,
                    "start_region_line": 182
                },
                {
                    "end_outermost_loop": 186,
                    "end_region_line": 186,
                    "line": "        merges.append((merge_pair[0].encode(\"utf-8\"), merge_pair[1].encode(\"utf-8\")))\n",
                    "lineno": 186,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 182,
                    "start_region_line": 182
                },
                {
                    "end_outermost_loop": 187,
                    "end_region_line": 187,
                    "line": "    return vocab, merges\n",
                    "lineno": 187,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 187,
                    "start_region_line": 172
                },
                {
                    "end_outermost_loop": 188,
                    "end_region_line": 188,
                    "line": "\n",
                    "lineno": 188,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 188,
                    "start_region_line": 188
                },
                {
                    "end_outermost_loop": 189,
                    "end_region_line": 189,
                    "line": "\n",
                    "lineno": 189,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 189,
                    "start_region_line": 189
                },
                {
                    "end_outermost_loop": 197,
                    "end_region_line": 197,
                    "line": "def train_bpe_tinystories():\n",
                    "lineno": 190,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 190,
                    "start_region_line": 190
                },
                {
                    "end_outermost_loop": 191,
                    "end_region_line": 197,
                    "line": "    vocab, merges = train_bpe_tokenizer(\n",
                    "lineno": 191,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 191,
                    "start_region_line": 190
                },
                {
                    "end_outermost_loop": 192,
                    "end_region_line": 197,
                    "line": "        \"data/TinyStoriesV2-GPT4-train.txt\", 10_000, special_tokens=[\"\\u003c|endoftext|\\u003e\"]\n",
                    "lineno": 192,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 192,
                    "start_region_line": 190
                },
                {
                    "end_outermost_loop": 193,
                    "end_region_line": 197,
                    "line": "    )\n",
                    "lineno": 193,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 193,
                    "start_region_line": 190
                },
                {
                    "end_outermost_loop": 195,
                    "end_region_line": 197,
                    "line": "    with open(\"vocab_tinystories.json\", \"w\") as f:\n",
                    "lineno": 194,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.08818627478455766,
                    "n_cpu_percent_c": 8.290021298091536e-05,
                    "n_cpu_percent_python": 0.0004748007615964245,
                    "n_gpu_avg_memory_mb": 166.390625,
                    "n_gpu_peak_memory_mb": 166.390625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 7.471146822039031e-05,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 194,
                    "start_region_line": 190
                },
                {
                    "end_outermost_loop": 195,
                    "end_region_line": 197,
                    "line": "        json.dump({k: v.decode(\"utf-8\") for k, v in vocab.items() if k \\u003e 255}, f)\n",
                    "lineno": 195,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 195,
                    "start_region_line": 190
                },
                {
                    "end_outermost_loop": 197,
                    "end_region_line": 197,
                    "line": "    with open(\"merges_tinystories.json\", \"w\") as f:\n",
                    "lineno": 196,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 196,
                    "start_region_line": 190
                },
                {
                    "end_outermost_loop": 197,
                    "end_region_line": 197,
                    "line": "        json.dump([(x.decode(\"utf-8\"), y.decode(\"utf-8\")) for x, y in merges], f)\n",
                    "lineno": 197,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.09072655834407814,
                    "n_cpu_percent_c": 0.0020343635645855788,
                    "n_cpu_percent_python": 0.0009769556340605051,
                    "n_gpu_avg_memory_mb": 166.390625,
                    "n_gpu_peak_memory_mb": 166.390625,
                    "n_gpu_percent": 0.0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.00030779623305114174,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 197,
                    "start_region_line": 190
                },
                {
                    "end_outermost_loop": 198,
                    "end_region_line": 198,
                    "line": "\n",
                    "lineno": 198,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 198,
                    "start_region_line": 198
                },
                {
                    "end_outermost_loop": 199,
                    "end_region_line": 199,
                    "line": "\n",
                    "lineno": 199,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 199,
                    "start_region_line": 199
                },
                {
                    "end_outermost_loop": 201,
                    "end_region_line": 200,
                    "line": "if __name__ == \"__main__\":\n",
                    "lineno": 200,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 200,
                    "start_region_line": 200
                },
                {
                    "end_outermost_loop": 201,
                    "end_region_line": 201,
                    "line": "    train_bpe_tinystories()\n",
                    "lineno": 201,
                    "memory_samples": [],
                    "n_avg_mb": 0.0,
                    "n_copy_mb_s": 0.0,
                    "n_core_utilization": 0.0,
                    "n_cpu_percent_c": 0.0,
                    "n_cpu_percent_python": 0.0,
                    "n_gpu_avg_memory_mb": 0.0,
                    "n_gpu_peak_memory_mb": 0.0,
                    "n_gpu_percent": 0,
                    "n_growth_mb": 0.0,
                    "n_malloc_mb": 0.0,
                    "n_mallocs": 0,
                    "n_peak_mb": 0.0,
                    "n_python_fraction": 0,
                    "n_sys_percent": 0.0,
                    "n_usage_fraction": 0.0,
                    "start_outermost_loop": 201,
                    "start_region_line": 201
                }
            ],
            "percent_cpu_time": 99.95268207834502
        }
    },
    "gpu": true,
    "gpu_device": "GPU",
    "growth_rate": 36.35117247837207,
    "max_footprint_fname": "/Users/saudi/Desktop/language-modeling-from-scratch/assignments/assignment1-basics/cs336_basics/train_bpe.py",
    "max_footprint_lineno": 146,
    "max_footprint_mb": 70.05846881866455,
    "max_footprint_python_fraction": 0.999345,
    "memory": true,
    "program": "/Users/saudi/Desktop/language-modeling-from-scratch/assignments/assignment1-basics/cs336_basics/train_bpe.py",
    "samples": [
        [
            4662766416,
            20.78921604156494
        ],
        [
            4952319750,
            7.349754333496094
        ],
        [
            9154219375,
            20.455394744873047
        ],
        [
            9553735125,
            20.469736099243164
        ],
        [
            10066908333,
            20.479124069213867
        ],
        [
            11744021833,
            20.37134075164795
        ],
        [
            13542766458,
            6.935967445373535
        ],
        [
            15724599083,
            6.853946685791016
        ],
        [
            15728719750,
            20.289413452148438
        ],
        [
            17478025000,
            6.7417755126953125
        ],
        [
            18846851416,
            20.279366493225098
        ],
        [
            19283084083,
            20.202765464782715
        ],
        [
            19911867333,
            6.767388343811035
        ],
        [
            20161020708,
            19.99674415588379
        ],
        [
            20219094083,
            20.048425674438477
        ],
        [
            20627212500,
            20.111923217773438
        ],
        [
            21152351666,
            20.111848831176758
        ],
        [
            21942973291,
            6.5464324951171875
        ],
        [
            22316942375,
            6.674386978149414
        ],
        [
            22687408666,
            6.674802780151367
        ],
        [
            26521018625,
            6.563162803649902
        ],
        [
            26587461208,
            6.474333763122559
        ],
        [
            30669011125,
            19.81494426727295
        ],
        [
            31813856000,
            6.378911018371582
        ],
        [
            32291768625,
            6.399407386779785
        ],
        [
            32782213708,
            19.742000579833984
        ],
        [
            34653154125,
            6.197818756103516
        ],
        [
            35027204291,
            19.631522178649902
        ],
        [
            35068358250,
            6.307165145874023
        ],
        [
            35526508416,
            19.64719295501709
        ],
        [
            35962895750,
            6.109147071838379
        ],
        [
            36604804458,
            6.209664344787598
        ],
        [
            46322970375,
            6.013035774230957
        ],
        [
            48748220500,
            19.266796112060547
        ],
        [
            53242406875,
            4.021418571472168
        ],
        [
            53725058541,
            5.928249359130859
        ],
        [
            53741274583,
            19.17733097076416
        ],
        [
            56254201041,
            5.731725692749023
        ],
        [
            56338684083,
            19.0831241607666
        ],
        [
            57288779208,
            19.070149421691895
        ],
        [
            57674357875,
            19.182682037353516
        ],
        [
            57728178458,
            1.175826072692871
        ],
        [
            57851800250,
            14.5137939453125
        ],
        [
            58479875708,
            5.635560035705566
        ],
        [
            58859793500,
            5.750026702880859
        ],
        [
            59064577541,
            1.0804252624511719
        ],
        [
            62231382708,
            5.547178268432617
        ],
        [
            65162910458,
            0.8923816680908203
        ],
        [
            66359771750,
            5.3574676513671875
        ],
        [
            68297137791,
            18.523672103881836
        ],
        [
            73481627375,
            0.7061500549316406
        ],
        [
            76427471208,
            18.1419620513916
        ],
        [
            76971526916,
            13.864592552185059
        ],
        [
            79991045291,
            18.048346519470215
        ],
        [
            81035425625,
            18.139731407165527
        ],
        [
            82303679416,
            4.600844383239746
        ],
        [
            87012875000,
            13.38650894165039
        ],
        [
            89763637666,
            4.4314069747924805
        ],
        [
            89808952583,
            0
        ],
        [
            93090682000,
            0
        ],
        [
            95200761291,
            4.246493339538574
        ],
        [
            95478470750,
            17.667144775390625
        ],
        [
            97382717708,
            4.229366302490234
        ],
        [
            98968946208,
            17.489726066589355
        ],
        [
            100067827375,
            17.48247718811035
        ],
        [
            100781533333,
            17.398353576660156
        ],
        [
            103923092375,
            17.386473655700684
        ],
        [
            105678187875,
            3.9519758224487305
        ],
        [
            106321770708,
            17.212169647216797
        ],
        [
            106353109208,
            0
        ],
        [
            106441530083,
            0
        ],
        [
            107527538500,
            3.855062484741211
        ],
        [
            108610103916,
            13.342316627502441
        ],
        [
            108775342708,
            13.339323997497559
        ],
        [
            122085418791,
            59.992777824401855
        ],
        [
            122085430250,
            0
        ],
        [
            122085434000,
            0
        ],
        [
            122085435166,
            0
        ],
        [
            122085436875,
            0
        ],
        [
            122085437416,
            0
        ],
        [
            122085441250,
            0
        ],
        [
            122085446958,
            0
        ],
        [
            122085448041,
            0
        ],
        [
            122085450666,
            0
        ],
        [
            122085451208,
            0
        ],
        [
            122085452166,
            0
        ],
        [
            122085452666,
            0
        ],
        [
            122085453708,
            0
        ],
        [
            122085455208,
            0
        ],
        [
            122085455708,
            0
        ],
        [
            122085456250,
            0
        ],
        [
            122085458375,
            0
        ],
        [
            122085461416,
            0
        ],
        [
            122085462416,
            0
        ],
        [
            122085462875,
            0
        ],
        [
            122085466666,
            0
        ],
        [
            122085467666,
            0
        ],
        [
            122085468166,
            0
        ],
        [
            186355759625,
            10.003443717956543
        ],
        [
            1321995965958,
            40.0118522644043
        ]
    ],
    "stacks": []
}
